<?xml version="1.0" encoding="UTF-8" ?>
<beans xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/beans"
          xmlns:oauth="http://www.springframework.org/schema/security/oauth2"
          xmlns:util="http://www.springframework.org/schema/util"
          xmlns:aop="http://www.springframework.org/schema/aop"
          xsi:schemaLocation="http://www.springframework.org/schema/security/oauth2 https://www.springframework.org/schema/security/spring-security-oauth2-2.0.xsd
        http://www.springframework.org/schema/security https://www.springframework.org/schema/security/spring-security.xsd
        http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/util https://www.springframework.org/schema/util/spring-util.xsd
        http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd">


    <oauth:authorization-server
                    client-details-service-ref="jdbcClientDetailsService"
                    token-services-ref="tokenServices"
                    user-approval-handler-ref="userManagedApprovalHandler"
                    authorization-request-manager-ref="authorizationRequestManager"
                    request-validator-ref="oauth2RequestValidator">
        <!-- Removed default AuthorizationCodeTokenGranter to be able to introduce the PkceEnhancedAuthorizationCodeTokenGranter see below -->
        <!-- <oauth:authorization-code authorization-code-services-ref="authorizationCodeServices"/> -->
        <oauth:authorization-code disabled="true"/>
        <oauth:implicit/>
        <oauth:refresh-token/>
        <oauth:client-credentials/>
        <oauth:password authentication-manager-ref="compositeAuthenticationManager"/>
    </oauth:authorization-server>

</beans>
